<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Secret</title>
    <!-- å¼•å…¥ Crypto-JS åº“ (ä½¿ç”¨ CDN ç¡®ä¿è¿è¡Œç¯å¢ƒå¯ç”¨æ€§) -->
    <script src="./crypto-js.min.js"></script>
    
    <!-- æ ·å¼ï¼šåªæ§åˆ¶é•¿å®½ï¼Œä¸åŠ é¢å¤–è£…é¥°æ ·å¼ -->
    <style>
        html, body {
            margin: 0;
            padding: 0;
        }

        #crypto-tool {
            max-width: 480px;
            box-sizing: border-box;
        }

        #decryption-ui,
        #encrypt-section {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        input[type="text"] {
            width: 90vw;       /* å®½åº¦ä¸ºå±å¹•å®½åº¦çš„ 90% */
            max-width: 100%;   /* ä¸è¶…è¿‡å®¹å™¨æœ¬èº«å®½åº¦ */
            box-sizing: border-box;
        }

        textarea {
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        /* è§£å¯†æˆåŠŸç»“æœåŒºåŸŸï¼šå®½åº¦é™å®šä¸ºè§†å£å®½åº¦çš„ 90%ï¼Œé˜²æ­¢è¶…å‡ºå±å¹• */
        .decrypt-result { /* è§£å¯†ç»“æœåŒºåŸŸå®½åº¦æ§åˆ¶ */
            max-width: 90vw;
            box-sizing: border-box;
        }

        .decrypt-result pre { /* è®©å†…å®¹åœ¨å®½åº¦å†…æ¢è¡Œ */
            white-space: pre-wrap;
            word-break: break-word;
        }

        /* 1. éšè— details æ ‡ç­¾çš„å±•å¼€/æŠ˜å ç®­å¤´ */
        details > summary {
            list-style: none; /* For standard browsers */
        }
        /* é’ˆå¯¹ WebKit æµè§ˆå™¨ (Chrome, Safari) */
        details > summary::-webkit-details-marker {
            display: none;
        }
        
        /* 2. ä½¿ summary æ–‡æœ¬ä¸å¯è§ */
        /* ä½¿ç”¨ transparent (é€æ˜) ç¡®ä¿æ— è®ºèƒŒæ™¯é¢œè‰²å¦‚ä½•ï¼Œæ–‡å­—éƒ½ä¸å¯è§ */
        #crypto-tool details > summary {
            color: transparent;
        }
    </style>
</head>
<body>
    <div id="crypto-tool">
        
        <!-- ğŸ”“ è§£å¯†éƒ¨åˆ† - å®Œå…¨å±•å¼€ -->
        <div id="decrypt-section">
            
            <div id="decryption-ui">
                <input type="text" id="decryptPasswordKey" placeholder="Write something..." value="Write something...">
                
                <div>
                    <button onclick="performFixedDecryption('decryptPasswordKey')">Do it!</button>
                </div>
            </div>
            
            <div id="decrypt-status"></div>
        </div>
        

        <!-- ğŸ›¡ï¸ åŠ å¯†éƒ¨åˆ† - é»˜è®¤æŠ˜å ï¼ŒSummaryæ–‡æœ¬ä¸å¯è§ä¸”æ— ç®­å¤´ -->
        <details>
            <summary>Don't click me</summary>
            
            <div id="encrypt-section">
                <textarea id="encryptInputText" rows="5" cols="60" placeholder="bulabula..."></textarea><br/>
                
                <input type="text" id="encryptPasswordKey" placeholder="bulabula..." value="bulabula..."><br/>
                
                <button onclick="performOperation(true, 'encryptInputText', 'encryptPasswordKey', 'encryptOutputText')">bulabula...</button><br/>
                <textarea id="encryptOutputText" rows="5" cols="60" readonly placeholder="bulabula..."></textarea>
                
            </div>
        </details>
    </div>
    
    <script>
        
        // å›ºå®šçš„å¯†æ–‡ï¼Œä»…å­˜åœ¨äºJSä¸­
        const FIXED_CIPHERTEXT = 'U2FsdGVkX18kFt/j5mdUc4hpPcYWOHrfmfeJmlJe1T2MUBbrYzQecurstItyPQ18/dEBMs880vSq1miZPM/tDV1l+gFzE10hWVB15GY1ef/E2h7//iPmF2wNG2TtY7ER';
        
        /**
         * é’ˆå¯¹å›ºå®šå¯†æ–‡çš„è§£å¯†æ“ä½œ
         * @param {string} passwordId å¯†ç è¾“å…¥æ¡†çš„ ID
         */
        function performFixedDecryption(passwordId) {
            // éœ€è¦ Crypto-JS åº“å·²åŠ è½½
            if (typeof CryptoJS === 'undefined') {
                alert("é”™è¯¯ï¼šCrypto-JS åº“æœªåŠ è½½ã€‚è¯·æ£€æŸ¥ CDN é“¾æ¥ã€‚");
                return;
            }
            const passwordKeyEl = document.getElementById(passwordId);
            const decryptSection = document.getElementById('decrypt-section');
            const statusDiv = document.getElementById('decrypt-status');
            const password = passwordKeyEl.value;
            const ciphertext = FIXED_CIPHERTEXT;
            
            statusDiv.innerHTML = "æ­£åœ¨è§£å¯†...";
            if (!password) {
                statusDiv.innerHTML = "å¯†ç ä¸èƒ½ä¸ºç©ºï¼";
                return;
            }
            try {
                const bytes = CryptoJS.AES.decrypt(ciphertext, password);
                const plaintext = bytes.toString(CryptoJS.enc.Utf8);
                
                // æ£€æŸ¥æ˜¯å¦è§£å¯†æˆåŠŸï¼ˆå¦‚æœè§£å¯†å¤±è´¥ï¼Œé€šå¸¸ä¼šè¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œæˆ–è€…ä¸ç¬¦åˆé¢„æœŸçš„å†…å®¹ï¼‰
                if (plaintext === "" && ciphertext.length > 0) {
                    throw new Error("å¯†ç ä¸æ­£ç¡®æˆ–å¯†æ–‡å·²æŸåã€‚");
                }
                
                // --- æ ¸å¿ƒï¼šæ›¿æ¢æ•´ä¸ªè§£å¯†åŒºåŸŸçš„å†…å®¹ ---
                decryptSection.innerHTML = `
                    <div class="decrypt-result">
                        <h3>âœ… Decryption Success</h3>
                        <pre>${plaintext}</pre>
                    </div>
                `;
            } catch (error) {
                console.error("Decryption failed:", error);
                const errorMessage = `Decryption failed: ${error.message}`;
                statusDiv.innerHTML = errorMessage;
                alert(errorMessage);
            }
        }
        
        /**
         * æ ¸å¿ƒæ“ä½œå‡½æ•° (ç”¨äºåŠ å¯†éƒ¨åˆ†)
         */
        function performOperation(isEncrypt, inputId, passwordId, outputId) {
            // éœ€è¦ Crypto-JS åº“å·²åŠ è½½
            if (typeof CryptoJS === 'undefined') {
                alert("é”™è¯¯ï¼šCrypto-JS åº“æœªåŠ è½½ã€‚è¯·æ£€æŸ¥ CDN é“¾æ¥ã€‚");
                return;
            }
            const inputTextEl = document.getElementById(inputId);
            const passwordKeyEl = document.getElementById(passwordId);
            const outputTextarea = document.getElementById(outputId);
            const text = inputTextEl.value.trim();
            const password = passwordKeyEl.value;
            
            outputTextarea.value = "Processing...";
            if (!text || !password) {
                alert('Text and password cannot be empty!');
                outputTextarea.value = "";
                return;
            }
            try {
                // --- åŠ å¯†æµç¨‹ ---
                const ciphertext = CryptoJS.AES.encrypt(text, password).toString();
                outputTextarea.value = ciphertext;
            } catch (error) {
                console.error("Operation failed:", error);
                const errorMessage = "Encryption failed, check input.";
                
                outputTextarea.value = errorMessage;
                alert(errorMessage);
            }
        }
    </script>
</body>
</html>